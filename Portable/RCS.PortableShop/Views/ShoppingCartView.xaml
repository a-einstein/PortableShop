<?xml version="1.0" encoding="UTF-8"?>

<BaseClasses:ImplicitModelView
    x:Class="RCS.PortableShop.Views.ShoppingCartView"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:NumericUpDown="clr-namespace:Syncfusion.SfNumericUpDown.XForms;assembly=Syncfusion.SfNumericUpDown.XForms"
    xmlns:BaseClasses="clr-namespace:RCS.PortableShop.Common.Views;assembly=RCS.PortableShop.Common"
    xmlns:Views="clr-namespace:RCS.PortableShop.Views;assembly=RCS.PortableShop"
    xmlns:ViewModels="clr-namespace:RCS.PortableShop.ViewModels;assembly=RCS.PortableShop"
    xmlns:Converters="clr-namespace:RCS.PortableShop.Common.Converters;assembly=RCS.PortableShop.Common"
    xmlns:Localization="clr-namespace:RCS.PortableShop.Localization;assembly=RCS.PortableShop"
    BaseClasses:View.ViewModel="{x:Static ViewModels:ShoppingCartViewModel.Instance}"
    BackgroundColor="{DynamicResource CartLevel0Colour}"
    Padding="{DynamicResource ViewPadding}"
    >

    <BaseClasses:View.Resources>
        <ResourceDictionary>
            <!--<Converters:SizeFormatter x:Key="SizeFormatter"/>-->
        </ResourceDictionary>
    </BaseClasses:View.Resources>

    <StackLayout>
        <Views:ShoppingCartSummaryView/>

        <ScrollView>
            <ListView x:Name="shoppingCartItemsListView" ItemsSource="{Binding Items}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>
                            <Grid Style="{DynamicResource ListItemStyle}" BackgroundColor="{DynamicResource CartLevel1Colour}">
                                <!--Note this layout currently is aimed towards portrait orientation.-->
                                <StackLayout Orientation="Vertical" Style="{DynamicResource CartItemStyle}">
                                    <Label Text="{Binding Name}" FontAttributes="Bold"/>

                                    <StackLayout Orientation="Horizontal">
                                        <Label Text="{Binding ProductSize}"/>
                                        <Label Text="{Binding ProductSizeUnitMeasureCode}"/>
                                        <Label Text="{Binding ProductColor}"/>
                                        <Label Text="{Binding ProductListPrice, StringFormat=\{0:C2\}}"/>
                                        <Label Text="{Binding Value, StringFormat=\{0:C2\}}" FontAttributes="Bold"/>
                                    </StackLayout>

                                    <StackLayout Orientation="Horizontal">
                                        <!--Note this need HorizontalOptions to prevent taking all width. It is hard to reduce its size, because of its Buttons to start with. WidthRequest needs to be considerable large to preserve the text area. HeightRequest only crops it.-->
                                        <!--Note the (differently named) FontAttribute does not work. Fontsize is numeric instead of an enum.-->
                                        <NumericUpDown:SfNumericUpDown Value="{Binding Quantity, Mode=TwoWay}" HorizontalOptions="Start" WidthRequest="130" FontSize="10" FontAttribute="Bold" TextColor="Black"/>

                                        <!--Note that HeightRequest usually only fucks the Button up, while FontSize does not do anything. -->
                                        <Button Text="{Localization:Translate Remove}" Command="{Binding BindingContext.DeleteCommand, Source={x:Reference shoppingCartItemsListView}}" CommandParameter="{Binding}" BackgroundColor="{DynamicResource WarningColour}" HorizontalOptions="Start" WidthRequest="30"/>
                                    </StackLayout>
                                </StackLayout>
                            </Grid>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </ScrollView>
    </StackLayout>
</BaseClasses:ImplicitModelView>
